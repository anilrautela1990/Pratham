<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center pageTitle">
   <h1>Unit Allocation</h1>
</div>
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center pageTitle marginBottom20">
   <ol class="breadcrumb">
      <li><a href="#">Home</a></li>
      <li class="active">Pre-Sales</li>
      <li class="active">Unit Allocation</li>
   </ol>
</div>
<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
   <form class="form" name="unitAllocationForm">
      <div>
         <select ng-model="projectDetails.projectName" name="projectName" class="form-control" ng-change="getPhaseList(projectDetails.projectName)" ng-required="true" ng-class="{blankInput: unitAllocationForm.projectName.$error.required &amp;&amp; submit}" autofocus="true">
            <option value="">
               Project
            </option>
            <option ng-repeat="x in projectList" value="{{x.ProjId}}">
               {{x.Proj_Name}}
            </option>
         </select>
      </div>
      <div>
         <select ng-model="projectDetails.phase" name="phase" class="form-control" ng-change="getBlockList(projectDetails.phase,projectDetails.projectName)" ng-required="true" ng-class="{blankInput: unitAllocationForm.phase.$error.required &amp;&amp; submit}">
            <option value="">
               Phase
            </option>
            <option ng-repeat="x in phaseList" value="{{x.Phase_Id}}">
               {{x.Phase_Name}}
            </option>
         </select>
      </div>
      <div class="divLabel">
         Type: <strong ng-model="projectDetails.flatType">{{flatType}}</strong>
      </div>
      <div>
         <select ng-model="projectDetails.blocks" name="blocks" class="form-control">
            <option value="">
                All Blocks
            </option>
            <option ng-repeat="x in blockList" value="{{x.Blocks_Id}}">
               {{x.Blocks_Name}}
            </option>
         </select>
      </div>
       <div class="text-right">
       <button type="button" class="btn btn-primary" ng-click="getUnitAllocation(projectDetails,'unitAllocationForm')">Get Units</button>
       </div>
   </form>
</div>
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 marginTop20">
    <table class="table borderDef">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Mobile</th>
                <!--<th>Project</th>
                <th>Phase</th>
                <th>Type</th>
                <th>Block</th>-->
                <th>Unit Detail</th>
                <th>Status</th>
                <th>Update Status</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="x in unitAllocationData">
                <td>{{x.name}}</td>
                <td>{{x.email}}</td>
                <td>{{x.mobile}}</td>
                <!--<td>{{x.projName}}</td>
                <td>{{x.phaseName}}</td>
                <td>{{x.phaseType}}</td>
                <td>{{x.unitObj}}</td>-->
                <td>Flat No.{{x.unitObj.UnitDtls_No}} - {{x.unitObj.UnitDtls_Name}} - {{x.unitObj.UnitDtls_Msrmnt}} Sq.Ft. - Floor {{x.unitObj.UnitDtls_Floor}} / Unit ID {{x.unitObj.UnitDtls_Id}} </td>
                <td class="text-center">
                    <div class="unitStatus" ng-class="unitStatus[x.unitObj.ProjDtl_Status-1]" title="{{unitStatusText[x.unitObj.ProjDtl_Status-1]}}"></div>
                </td>
                <td>
                    <button type="button" class="btn btn-primary" ng-click="updateUnitAllocationStatus(x)">Update Status</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<script type="text/ng-template" id="unitStatusUpdate.html">
        <div class="modal-header">
			<button type="button" class="close" ng-click="ok()">&times;</button>
            <h3 class="modal-title" id="modal-title">{{unit.name}}</h3>
        </div>
        <div class="modal-body" id="modal-body">
			<div class="subHeading">Update Status</div>
			<table class="leadDetail">
				<tr>
					<td>Status to Update:</td>
					<td>
                        <select name="firmBranch" class="form-control" name="updateStatus" ng-model="unit.updateStatus">
                            <option value="">Select</option>
                            <option value="4">Blocked by paying advance</option>
                            <option value="5">Blocked by not paying advance</option>
                            <option value="6">Sold</option>
                        </select>
                    </td>
				</tr>
            </table>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" type="button" ng-click="updateStatus(unit)">Update Status</button>
        </div>
    </script>